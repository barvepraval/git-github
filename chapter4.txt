this is chapter 4, modified in firstbranch